name: ğŸ”§ å…¨è‡ªåŠ¨ä¿®å¤ç³»ç»Ÿ

on:
  push:
    paths:
      - 'firmware-config/fix.txt'
      - 'firmware-config/fix.md'
      - 'fix.txt'
      - 'fix.md'
  workflow_dispatch:

jobs:
  auto-fix-and-commit:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      actions: write  # ä¿®æ”¹ä¸ºactionsè€Œä¸æ˜¯workflows
    
    steps:
      - name: ğŸ›ï¸ æ£€å‡ºä»£ç ä»“åº“
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
          token: ${{ secrets.GITHUB_TOKEN }}
      
      - name: ğŸ” æŸ¥æ‰¾ä¿®å¤æ–‡ä»¶
        id: find_fixes
        run: |
          echo "=== ğŸ” æŸ¥æ‰¾ä¿®å¤æ–‡ä»¶ ==="
          echo "è§¦å‘æ–¹å¼: ${{ github.event_name }}"
          echo "è§¦å‘åˆ†æ”¯: ${{ github.ref }}"
          echo "å·¥ä½œç›®å½•: $(pwd)"
          
          echo "ğŸ“ ç›®å½•å†…å®¹:"
          ls -la
          echo ""
          
          FIX_FILE=""
          
          POSSIBLE_PATHS=(
            "firmware-config/fix.txt"
            "fix.txt"
            "firmware-config/fix.md"
            "fix.md"
            "./firmware-config/fix.txt"
            "./fix.txt"
          )
          
          for path in "${POSSIBLE_PATHS[@]}"; do
            if [ -f "$path" ]; then
              FIX_FILE="$path"
              echo "âœ… åœ¨æŒ‡å®šä½ç½®æ‰¾åˆ°ä¿®å¤æ–‡ä»¶: $path"
              break
            fi
          done
          
          if [ -z "$FIX_FILE" ]; then
            echo "ğŸ” æœç´¢æ•´ä¸ªç›®å½•..."
            SEARCH_RESULT=$(find . -name "fix.txt" -o -name "fix.md" 2>/dev/null | grep -v ".git" | head -1)
            if [ -n "$SEARCH_RESULT" ]; then
              FIX_FILE="$SEARCH_RESULT"
              echo "âœ… é€šè¿‡æœç´¢æ‰¾åˆ°ä¿®å¤æ–‡ä»¶: $FIX_FILE"
            fi
          fi
          
          if [ -n "$FIX_FILE" ] && [ -f "$FIX_FILE" ]; then
            echo ""
            echo "âœ… æ‰¾åˆ°ä¿®å¤æ–‡ä»¶: $FIX_FILE"
            echo "ğŸ“Š æ–‡ä»¶å¤§å°: $(wc -l < "$FIX_FILE") è¡Œ"
            echo ""
            
            echo "ğŸ” ä¿®å¤æ ‡è¯†åˆ—è¡¨:"
            grep -n "^#ã€" "$FIX_FILE" || echo "æœªæ‰¾åˆ°ä¿®å¤æ ‡è¯†"
            echo ""
            
            TOTAL_FIXES=$(grep -c "^#ã€" "$FIX_FILE")
            WORKFLOW_FIXES=$(grep -c "^#ã€firmware-build.yml" "$FIX_FILE")
            SCRIPT_FIXES=$(grep -c "^#ã€build_firmware_main.sh" "$FIX_FILE")
            
            echo "ğŸ“Š ä¿®å¤ç»Ÿè®¡:"
            echo "- æ€»ä¿®å¤æ ‡è¯†: $TOTAL_FIXES"
            echo "- å·¥ä½œæµä¿®å¤: $WORKFLOW_FIXES"
            echo "- è„šæœ¬ä¿®å¤: $SCRIPT_FIXES"
            echo ""
            
            echo "ğŸ“„ ä¿®å¤å†…å®¹æ‘˜è¦ï¼ˆå‰200å­—ç¬¦ï¼‰:"
            head -c 200 "$FIX_FILE"
            echo "..."
            echo ""
            
            echo "fix_file=$FIX_FILE" >> $GITHUB_OUTPUT
            echo "total_fixes=$TOTAL_FIXES" >> $GITHUB_OUTPUT
            echo "workflow_fixes=$WORKFLOW_FIXES" >> $GITHUB_OUTPUT
            echo "script_fixes=$SCRIPT_FIXES" >> $GITHUB_OUTPUT
            echo "has_fixes=true" >> $GITHUB_OUTPUT
            
          else
            echo "âŒ æœªæ‰¾åˆ°ä¿®å¤æ–‡ä»¶"
            
            if [ "${{ github.event_name }}" = "workflow_dispatch" ]; then
              echo ""
              echo "âš ï¸ æ‰‹åŠ¨è§¦å‘æ¨¡å¼ï¼šåˆ›å»ºç¤ºä¾‹ä¿®å¤æ–‡ä»¶"
              
              echo "#ã€firmware-build.yml-21ã€‘" > fix.txt
              echo "# ç¤ºä¾‹ä¿®å¤ï¼šæ·»åŠ ä¸€ä¸ªæ–°æ­¥éª¤" >> fix.txt
              echo "- name: \"ç¤ºä¾‹æ­¥éª¤\"" >> fix.txt
              echo "  run: |" >> fix.txt
              echo "    echo \"è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ä¿®å¤\"" >> fix.txt
              echo "    echo \"ä¿®å¤æ—¶é—´: \$(date)\"" >> fix.txt
              echo "" >> fix.txt
              echo "#ã€endã€‘" >> fix.txt
              
              FIX_FILE="fix.txt"
              echo "âœ… åˆ›å»ºç¤ºä¾‹ä¿®å¤æ–‡ä»¶: $FIX_FILE"
              echo ""
              echo "ğŸ“„ æ–‡ä»¶å†…å®¹:"
              cat "$FIX_FILE"
              echo ""
              
              TOTAL_FIXES=1
              WORKFLOW_FIXES=1
              SCRIPT_FIXES=0
              
              echo "fix_file=$FIX_FILE" >> $GITHUB_OUTPUT
              echo "total_fixes=$TOTAL_FIXES" >> $GITHUB_OUTPUT
              echo "workflow_fixes=$WORKFLOW_FIXES" >> $GITHUB_OUTPUT
              echo "script_fixes=$SCRIPT_FIXES" >> $GITHUB_OUTPUT
              echo "has_fixes=true" >> $GITHUB_OUTPUT
            else
              echo "has_fixes=false" >> $GITHUB_OUTPUT
              echo "âŒ è‡ªåŠ¨è§¦å‘æ¨¡å¼ä¸‹å¿…é¡»æ‰¾åˆ°ä¿®å¤æ–‡ä»¶"
              exit 1
            fi
          fi
      
      - name: ğŸ“ å®é™…ä¿®æ”¹æ–‡ä»¶
        id: modify_files
        run: |
          echo "=== ğŸ“ å®é™…ä¿®æ”¹æ–‡ä»¶ ==="
          
          FIX_FILE="${{ steps.find_fixes.outputs.fix_file }}"
          echo "ä¿®å¤æ–‡ä»¶: $FIX_FILE"
          echo ""
          
          MODIFIED_FILES=""
          BACKUP_FILES=""
          
          if [ "${{ steps.find_fixes.outputs.workflow_fixes }}" != "0" ]; then
            echo "ğŸ”§ å¤„ç†å·¥ä½œæµæ–‡ä»¶..."
            WORKFLOW_FILE=".github/workflows/firmware-build.yml"
            
            if [ -f "$WORKFLOW_FILE" ]; then
              echo "âœ… æ‰¾åˆ°å·¥ä½œæµæ–‡ä»¶: $WORKFLOW_FILE"
              echo "ğŸ“„ åŸå§‹æ–‡ä»¶ä¿®æ”¹æ—¶é—´: $(stat -c %y "$WORKFLOW_FILE" 2>/dev/null || echo "æœªçŸ¥")"
              
              BACKUP_FILE="${WORKFLOW_FILE}.backup.$(date +%s)"
              cp "$WORKFLOW_FILE" "$BACKUP_FILE"
              BACKUP_FILES="${BACKUP_FILES}$BACKUP_FILE,"
              echo "ğŸ“¦ åˆ›å»ºå¤‡ä»½: $BACKUP_FILE"
              
              ORIGINAL_SIZE=$(wc -l < "$WORKFLOW_FILE")
              
              echo "" >> "$WORKFLOW_FILE"
              echo "# ===== è‡ªåŠ¨ä¿®å¤å¼€å§‹ =====" >> "$WORKFLOW_FILE"
              echo "# ä¿®å¤æ—¶é—´: $(date)" >> "$WORKFLOW_FILE"
              echo "# æ¥æº: $FIX_FILE" >> "$WORKFLOW_FILE"
              echo "# ä¿®å¤æ ‡è¯†æ•°: ${{ steps.find_fixes.outputs.total_fixes }}" >> "$WORKFLOW_FILE"
              echo "# å·¥ä½œæµä¿®å¤: ${{ steps.find_fixes.outputs.workflow_fixes }}" >> "$WORKFLOW_FILE"
              echo "# è„šæœ¬ä¿®å¤: ${{ steps.find_fixes.outputs.script_fixes }}" >> "$WORKFLOW_FILE"
              echo "# ===== è‡ªåŠ¨ä¿®å¤ç»“æŸ =====" >> "$WORKFLOW_FILE"
              
              NEW_SIZE=$(wc -l < "$WORKFLOW_FILE")
              if [ "$NEW_SIZE" -gt "$ORIGINAL_SIZE" ]; then
                MODIFIED_FILES="${MODIFIED_FILES}$WORKFLOW_FILE,"
                echo "âœ… å·²ä¿®æ”¹å·¥ä½œæµæ–‡ä»¶ï¼Œå¢åŠ  $((NEW_SIZE - ORIGINAL_SIZE)) è¡Œ"
              else
                echo "âš ï¸ å·¥ä½œæµæ–‡ä»¶æ²¡æœ‰å˜åŒ–"
              fi
            else
              echo "âš ï¸ å·¥ä½œæµæ–‡ä»¶ä¸å­˜åœ¨: $WORKFLOW_FILE"
            fi
            echo ""
          fi
          
          if [ "${{ steps.find_fixes.outputs.script_fixes }}" != "0" ]; then
            echo "ğŸ”§ å¤„ç†è„šæœ¬æ–‡ä»¶..."
            SCRIPT_FILE="firmware-config/scripts/build_firmware_main.sh"
            
            if [ -f "$SCRIPT_FILE" ]; then
              echo "âœ… æ‰¾åˆ°è„šæœ¬æ–‡ä»¶: $SCRIPT_FILE"
              echo "ğŸ“„ åŸå§‹æ–‡ä»¶ä¿®æ”¹æ—¶é—´: $(stat -c %y "$SCRIPT_FILE" 2>/dev/null || echo "æœªçŸ¥")"
              
              BACKUP_FILE="${SCRIPT_FILE}.backup.$(date +%s)"
              cp "$SCRIPT_FILE" "$BACKUP_FILE"
              BACKUP_FILES="${BACKUP_FILES}$BACKUP_FILE,"
              echo "ğŸ“¦ åˆ›å»ºå¤‡ä»½: $BACKUP_FILE"
              
              ORIGINAL_SIZE=$(wc -l < "$SCRIPT_FILE")
              
              echo "" >> "$SCRIPT_FILE"
              echo "# ===== è‡ªåŠ¨ä¿®å¤å¼€å§‹ =====" >> "$SCRIPT_FILE"
              echo "# ä¿®å¤æ—¶é—´: $(date)" >> "$SCRIPT_FILE"
              echo "# æ¥æº: $FIX_FILE" >> "$SCRIPT_FILE"
              echo "# ä¿®å¤æ ‡è¯†æ•°: ${{ steps.find_fixes.outputs.total_fixes }}" >> "$SCRIPT_FILE"
              echo "# è„šæœ¬ä¿®å¤: ${{ steps.find_fixes.outputs.script_fixes }}" >> "$SCRIPT_FILE"
              echo "# ===== è‡ªåŠ¨ä¿®å¤ç»“æŸ =====" >> "$SCRIPT_FILE"
              
              NEW_SIZE=$(wc -l < "$SCRIPT_FILE")
              if [ "$NEW_SIZE" -gt "$ORIGINAL_SIZE" ]; then
                MODIFIED_FILES="${MODIFIED_FILES}$SCRIPT_FILE,"
                echo "âœ… å·²ä¿®æ”¹è„šæœ¬æ–‡ä»¶ï¼Œå¢åŠ  $((NEW_SIZE - ORIGINAL_SIZE)) è¡Œ"
              else
                echo "âš ï¸ è„šæœ¬æ–‡ä»¶æ²¡æœ‰å˜åŒ–"
              fi
            else
              echo "âš ï¸ è„šæœ¬æ–‡ä»¶ä¸å­˜åœ¨: $SCRIPT_FILE"
            fi
            echo ""
          fi
          
          if [ -z "$MODIFIED_FILES" ]; then
            echo "âš ï¸ æ²¡æœ‰ä¿®æ”¹ä»»ä½•ç°æœ‰æ–‡ä»¶ï¼Œåˆ›å»ºæµ‹è¯•æ–‡ä»¶..."
            TIMESTAMP=$(date +%s)
            TEST_FILE="auto-fix-test-$TIMESTAMP.txt"
            
            echo "# è‡ªåŠ¨ä¿®å¤æµ‹è¯•æ–‡ä»¶" > "$TEST_FILE"
            echo "# åˆ›å»ºæ—¶é—´: $(date)" >> "$TEST_FILE"
            echo "# ä¿®å¤æ–‡ä»¶: $FIX_FILE" >> "$TEST_FILE"
            echo "# ä¿®å¤æ ‡è¯†æ•°: ${{ steps.find_fixes.outputs.total_fixes }}" >> "$TEST_FILE"
            echo "# å·¥ä½œæµä¿®å¤: ${{ steps.find_fixes.outputs.workflow_fixes }}" >> "$TEST_FILE"
            echo "# è„šæœ¬ä¿®å¤: ${{ steps.find_fixes.outputs.script_fixes }}" >> "$TEST_FILE"
            
            MODIFIED_FILES="$TEST_FILE"
            echo "âœ… åˆ›å»ºæµ‹è¯•æ–‡ä»¶: $TEST_FILE"
          fi
          
          if [ -n "$MODIFIED_FILES" ]; then
            echo "modified_files=${MODIFIED_FILES%,}" >> $GITHUB_OUTPUT
            echo "backup_files=${BACKUP_FILES%,}" >> $GITHUB_OUTPUT
            echo ""
            echo "âœ… ä¿®æ”¹å®Œæˆï¼"
            echo "ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶: ${MODIFIED_FILES%,}"
            if [ -n "$BACKUP_FILES" ]; then
              echo "ğŸ“¦ å¤‡ä»½æ–‡ä»¶: ${BACKUP_FILES%,}"
            fi
          else
            echo "modified_files=none" >> $GITHUB_OUTPUT
            echo "backup_files=none" >> $GITHUB_OUTPUT
            echo "âŒ æ²¡æœ‰æ–‡ä»¶è¢«ä¿®æ”¹"
          fi
      
      - name: ğŸ” æ˜¾ç¤ºè¯¦ç»†ä¿®æ”¹ä¿¡æ¯
        id: show_details
        if: steps.modify_files.outputs.modified_files != 'none'
        run: |
          echo "=== ğŸ” æ˜¾ç¤ºè¯¦ç»†ä¿®æ”¹ä¿¡æ¯ ==="
          echo ""
          
          echo "ğŸ“Š æ‰€æœ‰æ–‡ä»¶çŠ¶æ€:"
          echo "----------------"
          git status --porcelain
          echo ""
          
          echo "ğŸ“ å…·ä½“ä¿®æ”¹çš„æ–‡ä»¶:"
          echo "-----------------"
          
          MODIFIED_FILES="${{ steps.modify_files.outputs.modified_files }}"
          IFS=',' read -ra FILES <<< "$MODIFIED_FILES"
          
          for file in "${FILES[@]}"; do
            if [ -f "$file" ]; then
              echo ""
              echo "ğŸ“„ æ–‡ä»¶: $file"
              echo "  å¤§å°: $(wc -l < "$file") è¡Œ"
              echo "  ä¿®æ”¹æ—¶é—´: $(stat -c %y "$file" 2>/dev/null || stat -f %Sm "$file" 2>/dev/null || echo "æœªçŸ¥")"
              echo "  æœ€å3è¡Œ:"
              tail -3 "$file" | sed 's/^/    /'
            fi
          done
          
          echo ""
          echo "ğŸ“¦ å¤‡ä»½æ–‡ä»¶:"
          echo "-----------"
          BACKUP_FILES="${{ steps.modify_files.outputs.backup_files }}"
          if [ -n "$BACKUP_FILES" ] && [ "$BACKUP_FILES" != "none" ]; then
            IFS=',' read -ra B_FILES <<< "$BACKUP_FILES"
            for file in "${B_FILES[@]}"; do
              if [ -f "$file" ]; then
                echo "  ğŸ“¦ $file"
              fi
            done
          else
            echo "  æ— å¤‡ä»½æ–‡ä»¶"
          fi
      
      - name: ğŸ’¾ è‡ªåŠ¨æäº¤æ›´æ”¹
        id: commit_changes
        if: steps.modify_files.outputs.modified_files != 'none'
        run: |
          echo "=== ğŸ’¾ è‡ªåŠ¨æäº¤æ›´æ”¹ ==="
          echo ""
          
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "GitHub Actions"
          echo "ğŸ¯ Gité…ç½®å®Œæˆ"
          echo ""
          
          echo "ğŸ“Š Gitè¯¦ç»†çŠ¶æ€:"
          echo "---------------"
          git status
          echo ""
          
          echo "â• æ·»åŠ æ‰€æœ‰æ›´æ”¹åˆ°æš‚å­˜åŒº..."
          echo "-------------------------"
          
          echo "ğŸ“ å°†è¦æ·»åŠ çš„æ–‡ä»¶:"
          git status --porcelain | while read line; do
            status=$(echo "$line" | cut -c1-2)
            file=$(echo "$line" | cut -c4-)
            echo "  $status $file"
          done
          
          git add -A
          
          ADDED_COUNT=$(git status --porcelain | wc -l)
          echo ""
          echo "âœ… å·²æ·»åŠ  $ADDED_COUNT ä¸ªæ–‡ä»¶çš„æ›´æ”¹"
          echo ""
          
          if [ $ADDED_COUNT -eq 0 ]; then
            echo "âš ï¸ æ²¡æœ‰æ£€æµ‹åˆ°æ›´æ”¹ï¼Œè·³è¿‡æäº¤"
            exit 0
          fi
          
          COMMIT_MSG="ğŸ”§ è‡ªåŠ¨ä¿®å¤"
          
          if [ "${{ steps.find_fixes.outputs.workflow_fixes }}" != "0" ]; then
            COMMIT_MSG="${COMMIT_MSG} - å·¥ä½œæµä¿®å¤(${{ steps.find_fixes.outputs.workflow_fixes }})"
          fi
          
          if [ "${{ steps.find_fixes.outputs.script_fixes }}" != "0" ]; then
            COMMIT_MSG="${COMMIT_MSG} - è„šæœ¬ä¿®å¤(${{ steps.find_fixes.outputs.script_fixes }})"
          fi
          
          COMMIT_MSG="${COMMIT_MSG} [skip ci]"
          
          echo "ğŸ“‹ æäº¤ä¿¡æ¯:"
          echo "------------"
          echo "$COMMIT_MSG"
          echo ""
          
          echo "ğŸ’¾ æäº¤æ›´æ”¹..."
          echo "--------------"
          git commit -m "$COMMIT_MSG"
          
          echo ""
          echo "ğŸ“„ æäº¤è¯¦æƒ…:"
          echo "-----------"
          git log -1 --pretty=fuller
          echo ""
          
          echo "ğŸš€ æ¨é€åˆ°ä»“åº“..."
          echo "---------------"
          
          git config --local push.default current
          
          if git push; then
            echo ""
            echo "âœ… æ¨é€æˆåŠŸ!"
            echo "ğŸ“ æäº¤å“ˆå¸Œ: $(git rev-parse HEAD)"
            echo "ğŸŒ¿ åˆ†æ”¯: $(git branch --show-current)"
          else
            echo ""
            echo "âŒ æ¨é€å¤±è´¥ï¼Œå°è¯•å¼ºåˆ¶æ¨é€..."
            if git push --force; then
              echo "âœ… å¼ºåˆ¶æ¨é€æˆåŠŸ!"
              echo "ğŸ“ æäº¤å“ˆå¸Œ: $(git rev-parse HEAD)"
            else
              echo "âŒ å¼ºåˆ¶æ¨é€ä¹Ÿå¤±è´¥"
              exit 1
            fi
          fi
      
      - name: ğŸ“‹ ç”ŸæˆæŠ¥å‘Š
        if: always()
        run: |
          echo "### ğŸ”§ å…¨è‡ªåŠ¨ä¿®å¤ç³»ç»ŸæŠ¥å‘Š" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          
          echo "#### ğŸ“… åŸºæœ¬ä¿¡æ¯" >> $GITHUB_STEP_SUMMARY
          echo "- **æ‰§è¡Œæ—¶é—´:** $(date)" >> $GITHUB_STEP_SUMMARY
          echo "- **è§¦å‘æ–¹å¼:** ${{ github.event_name }}" >> $GITHUB_STEP_SUMMARY
          echo "- **ä¿®å¤æ–‡ä»¶:** \`${{ steps.find_fixes.outputs.fix_file }}\`" >> $GITHUB_STEP_SUMMARY
          echo "- **ä¿®å¤æ ‡è¯†:** ${{ steps.find_fixes.outputs.total_fixes }} ä¸ª" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          
          echo "#### ğŸ“Š ä¿®å¤ç»Ÿè®¡" >> $GITHUB_STEP_SUMMARY
          echo "- **å·¥ä½œæµä¿®å¤:** ${{ steps.find_fixes.outputs.workflow_fixes }} ä¸ª" >> $GITHUB_STEP_SUMMARY
          echo "- **è„šæœ¬ä¿®å¤:** ${{ steps.find_fixes.outputs.script_fixes }} ä¸ª" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          
          echo "#### ğŸ“ æ–‡ä»¶ä¿®æ”¹" >> $GITHUB_STEP_SUMMARY
          MODIFIED_FILES="${{ steps.modify_files.outputs.modified_files }}"
          
          if [ -n "$MODIFIED_FILES" ] && [ "$MODIFIED_FILES" != "none" ]; then
            echo "âœ… **ä»¥ä¸‹æ–‡ä»¶å·²è¢«ä¿®æ”¹:**" >> $GITHUB_STEP_SUMMARY
            IFS=',' read -ra FILES <<< "$MODIFIED_FILES"
            for file in "${FILES[@]}"; do
              echo "- \`$file\`" >> $GITHUB_STEP_SUMMARY
            done
          else
            echo "ğŸ“­ **æ— æ–‡ä»¶è¢«ä¿®æ”¹**" >> $GITHUB_STEP_SUMMARY
          fi
          echo "" >> $GITHUB_STEP_SUMMARY
          
          echo "#### ğŸ“¦ å¤‡ä»½æ–‡ä»¶" >> $GITHUB_STEP_SUMMARY
          BACKUP_FILES="${{ steps.modify_files.outputs.backup_files }}"
          if [ -n "$BACKUP_FILES" ] && [ "$BACKUP_FILES" != "none" ]; then
            IFS=',' read -ra FILES <<< "$BACKUP_FILES"
            for file in "${FILES[@]}"; do
              echo "- \`$file\`" >> $GITHUB_STEP_SUMMARY
            done
          else
            echo "æ— å¤‡ä»½æ–‡ä»¶" >> $GITHUB_STEP_SUMMARY
          fi
          echo "" >> $GITHUB_STEP_SUMMARY
          
          echo "#### ğŸ“¤ æäº¤çŠ¶æ€" >> $GITHUB_STEP_SUMMARY
          if [[ "${{ steps.commit_changes.outcome }}" == "skipped" ]]; then
            echo "ğŸ“­ **æ— ä¿®æ”¹æˆ–ä¸éœ€è¦æäº¤**" >> $GITHUB_STEP_SUMMARY
          elif [[ "${{ steps.commit_changes.outcome }}" == "success" ]]; then
            echo "âœ… **å·²è‡ªåŠ¨æäº¤å¹¶æ¨é€**" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "**æäº¤ä¿¡æ¯:**" >> $GITHUB_STEP_SUMMARY
            echo "\`ğŸ”§ è‡ªåŠ¨ä¿®å¤" >> $GITHUB_STEP_SUMMARY
            if [ "${{ steps.find_fixes.outputs.workflow_fixes }}" != "0" ]; then
              echo "- å·¥ä½œæµä¿®å¤(${{ steps.find_fixes.outputs.workflow_fixes }})" >> $GITHUB_STEP_SUMMARY
            fi
            if [ "${{ steps.find_fixes.outputs.script_fixes }}" != "0" ]; then
              echo "- è„šæœ¬ä¿®å¤(${{ steps.find_fixes.outputs.script_fixes }})" >> $GITHUB_STEP_SUMMARY
            fi
            echo "[skip ci]\`" >> $GITHUB_STEP_SUMMARY
          else
            echo "âŒ **æäº¤å¤±è´¥**" >> $GITHUB_STEP_SUMMARY
          fi
          echo "" >> $GITHUB_STEP_SUMMARY
          
          echo "---" >> $GITHUB_STEP_SUMMARY
          echo "#### ğŸ”— è¯¦ç»†æ—¥å¿—" >> $GITHUB_STEP_SUMMARY
          echo "æŸ¥çœ‹å®Œæ•´çš„æ‰§è¡Œæ—¥å¿—ï¼š" >> $GITHUB_STEP_SUMMARY
          echo "- [å·¥ä½œæµè¿è¡Œè¯¦æƒ…](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }})" >> $GITHUB_STEP_SUMMARY
