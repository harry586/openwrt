name: 应用修复补丁

on: [workflow_dispatch]

jobs:

  apply-patch:

    runs-on: ubuntu-latest

    steps:

      - uses: actions/checkout@v4

      - name: 应用补丁

        run: |

          if [ -f "openwrt_fix.patch" ]; then

            git apply openwrt_fix.patch --whitespace=nowarn

            git config user.name "GitHub Actions"

            git config user.email "actions@github.com"

            git add .

            git commit -m "fix: 应用一键修复补丁" || echo "没有变更或已提交"

            git push

          fi
